# Test Report

<The goal of this document is to explain how the application was tested, detailing how the test cases were defined and what they cover>

# Contents

- [Test Report](#test-report)
- [Contents](#contents)
- [Dependency graph](#dependency-graph)
- [Integration approach](#integration-approach)
- [Tests](#tests)
- [Coverage](#coverage)
  - [Coverage of FR](#coverage-of-fr)
  - [Coverage white box](#coverage-white-box)

# Dependency graph

![Dependency_graph](./images/Dependency_graph.jpg)

# Integration approach

The approach used to write all the cases was top down. We analyzed the modules and wrote the tests starting from the top of the code. We firstly focused on unit testing using statement cooverage for all the modules and then on integration testing with black box approach for all the modules. The steps could be written as follows:<br>
step1: unit testing of A<br>
step2: unit testing of B<br>
step3: unit testing of C<br>
step4: integration testing of A<br>
step5: integration testing of B<br>
step6: integration testing of C<br>
Where A,B,C rappresent different modules of the API.

# Tests

<in the table below list the test cases defined For each test report the object tested, the test level (API, integration, unit) and the technique used to define the test case (BB/ eq partitioning, BB/ boundary, WB/ statement coverage, etc)> <split the table if needed>

| Test case name                                                                                          | Object(s) tested                 | Test level | Technique used      |
| ------------------------------------------------------------------------------------------------------- | -------------------------------- | ---------- | ------------------- |
| -exception, 500 error                                                                                   | register                         | unit       | statement coverage  |
| -nominal case                                                                                           | register                         | unit       | statement coverage  |
| -exception, missing password                                                                            | register                         | unit       | statement coverage  |
| -exception, missing email                                                                               | register                         | unit       | statement coverage  |
| -exception, missing username                                                                            | register                         | unit       | statement coverage  |
| -exception, empty username                                                                              | register                         | unit       | statement coverage  |
| -exception, empty email                                                                                 | register                         | unit       | statement coverage  |
| -exception, empty password                                                                              | register                         | unit       | statement coverage  |
| -exception, empty body                                                                                  | register                         | unit       | statement coverage  |
| -exception, already used email                                                                          | register                         | unit       | statement coverage  |
| -exception, already used username                                                                       | register                         | unit       | statement coverage  |
| -exception, wrong email format                                                                          | register                         | unit       | statement coverage  |
| -nominal case                                                                                           | registerAdmin                    | unit       | statement coverage  |
| -admin, exception, 500 error                                                                            | registerAdmin                    | unit       | statement coverage  |
| -admin, exception, missing password                                                                     | registerAdmin                    | unit       | statement coverage  |
| -admin, exception, missing email                                                                        | registerAdmin                    | unit       | statement coverage  |
| -admin, exception, missing username                                                                     | registerAdmin                    | unit       | statement coverage  |
| -admin, exception, empty username                                                                       | registerAdmin                    | unit       | statement coverage  |
| -admin, exception, empty email                                                                          | registerAdmin                    | unit       | statement coverage  |
| -admin, exception, empty password                                                                       | registerAdmin                    | unit       | statement coverage  |
| -admin, exception, empty body                                                                           | registerAdmin                    | unit       | statement coverage  |
| -admin, exception, already used email                                                                   | registerAdmin                    | unit       | statement coverage  |
| -admin, exception, already used username                                                                | registerAdmin                    | unit       | statement coverage  |
| -admin, exception, wrong email format                                                                   | registerAdmin                    | unit       | statement coverage  |
| -nominal case                                                                                           | login                            | unit       | statement coverage  |
| -exception, 500 error                                                                                   | login                            | unit       | statement coverage  |
| -exception, missing email                                                                               | login                            | unit       | statement coverage  |
| -exception, missing password                                                                            | login                            | unit       | statement coverage  |
| -exception, empty password                                                                              | login                            | unit       | statement coverage  |
| -exception, empty email                                                                                 | login                            | unit       | statement coverage  |
| -exception, empty body                                                                                  | login                            | unit       | statement coverage  |
| -exception, not valid email                                                                             | login                            | unit       | statement coverage  |
| -exception, wrong password                                                                              | login                            | unit       | statement coverage  |
| -exception, wrong user                                                                                  | login                            | unit       | statement coverage  |
| -Nominal scenario                                                                                       | logout                           | unit       | statement coverage  |
| -should return an error if refreshToken is missing in cookies                                           | logout                           | unit       | statement coverage  |
| -should return an error if user is not found                                                            | logout                           | unit       | statement coverage  |
| -should return a server error if an exception occurs                                                    | logout                           | unit       | statement coverage  |
| -Nominal case                                                                                           | createCategory                   | unit       | statement coverage  |
| -Exception case, no type or body                                                                        | createCategory                   | unit       | statement coverage  |
| -Exception case, empty type or body                                                                     | createCategory                   | unit       | statement coverage  |
| -Exception case, category already present in db                                                         | createCategory                   | unit       | statement coverage  |
| -Nominal case, admin call                                                                               | updateCategory                   | unit       | statement coverage  |
| -Exception case, body has missing info                                                                  | updateCategory                   | unit       | statement coverage  |
| -Exception case, body has empty info                                                                    | updateCategory                   | unit       | statement coverage  |
| -Exception case, old category does not exist                                                            | updateCategory                   | unit       | statement coverage  |
| -Exception case, new category already in db                                                             | updateCategory                   | unit       | statement coverage  |
| -Nominal case, admin call                                                                               | deleteCategory                   | unit       | statement coverage  |
| -Nominal case, admin call deleting all categories                                                       | deleteCategory                   | unit       | statement coverage  |
| -Exception case, user call                                                                              | deleteCategory                   | unit       | statement coverage  |
| -Exception case, types not passed                                                                       | deleteCategory                   | unit       | statement coverage  |
| -Exception case, only one category in db call                                                           | deleteCategory                   | unit       | statement coverage  |
| -Exception case, empty category passed                                                                  | deleteCategory                   | unit       | statement coverage  |
| -Exception case, one type is not in db                                                                  | deleteCategory                   | unit       | statement coverage  |
| -Exception case, not authorized                                                                         | getCategories                    | unit       | statement coverage  |
| -Nominal case                                                                                           | getCategories                    | unit       | statement coverage  |
| -Nominal case                                                                                           | createTransaction                | unit       | statement coverage  |
| -Exception case, unauthorized                                                                           | createTransaction                | unit       | statement coverage  |
| -Exception case, missing info in the body                                                               | createTransaction                | unit       | statement coverage  |
| -Exception case, parameter empty                                                                        | createTransaction                | unit       | statement coverage  |
| -Exception case, user in body is different than the one in params                                       | createTransaction                | unit       | statement coverage  |
| -Exception case, user in params does not exist                                                          | createTransaction                | unit       | statement coverage  |
| -Exception case, category not in db                                                                     | createTransaction                | unit       | statement coverage  |
| -Exception case, amount is not parsable                                                                 | createTransaction                | unit       | statement coverage  |
| -Nominal case                                                                                           | getAllTransactions               | unit       | statement coverage  |
| -Exception case, unauthorized                                                                           | getAllTransactions               | unit       | statement coverage  |
| -Nominal case, admin call                                                                               | getTransactionsByUser            | unit       | statement coverage  |
| -Exception case, user call on admin path                                                                | getTransactionsByUser            | unit       | statement coverage  |
| -Exception case, admin call, user in params does not exist                                              | getTransactionsByUser            | unit       | statement cooverage |
| -Nominal case, user call                                                                                | getTransactionsByUser            | unit       | statement coverage  |
| -Exception case, user call for another user's transactions                                              | getTransactionsByUser            | unit       | statement coverage  |
| -Exception case, user call username does not exist                                                      | getTransactionsByUser            | unit       | statement coverage  |
| -Nominal case, admin call                                                                               | getTransactionsByUserByCategory  | unit       | statement coverage  |
| -Exception case, user call on admin path                                                                | getTransactionsByUserByCategory  | unit       | statement coverage  |
| -Exception case, admin call, user in params does not exist                                              | getTransactionsByUserByCategory  | unit       | statement coverage  |
| -Exception case, admin call, category in params does not exist                                          | getTransactionsByUserByCategory  | unit       | statement coverage  |
| -Nominal case, user call                                                                                | getTransactionsByUserByCategory  | unit       | statement coverage  |
| -Exception case, user call for another user's transactions                                              | getTransactionsByUserByCategory  | unit       | statement coverage  |
| -Exception case, user call, username doesn't exist                                                      | getTransactionsByUserByCategory  | unit       | statement coverage  |
| -Exception case, user call, category does not exist                                                     | getTransactionsByUserByCategory  | unit       | statement coverage  |
| -Nominal case, admin call                                                                               | getTransactionsByGroup           | unit       | statement coverage  |
| -Exception case, user calls on admin path                                                               | getTransactionsByGroup           | unit       | statement coverage  |
| -Exception case, admin call group does not exist                                                        | getTransactionsByGroup           | unit       | statement coverage  |
| -Nominal case, user call                                                                                | getTransactionsByGroup           | unit       | statement coverage  |
| -Exception case, user not in group                                                                      | getTransactionsByGroup           | unit       | statement coverage  |
| -Nominal case, admin call                                                                               | getTransactionsByGroupByCategory | unit       | statement coverage  |
| -Exception case, user calls on admin path                                                               | getTransactionsByGroupByCategory | unit       | statement coverage  |
| -Exception case, admin call group does not exist                                                        | getTransactionsByGroupByCategory | unit       | statement coverage  |
| -Exception case, admin call category does not exist                                                     | getTransactionsByGroupByCategory | unit       | statement coverage  |
| -Nominal case, user call                                                                                | getTransactionsByGroupByCategory | unit       | statement coverage  |
| -Exception case, user call for another user's transactions                                              | getTransactionsByGroupByCategory | unit       | statement coverage  |
| -Exception case, user call, username doesn't exist                                                      | getTransactionsByGroupByCategory | unit       | statement coverage  |
| -Exception case, user call, category does not exist                                                     | getTransactionsByGroupByCategory | unit       | statement coverage  |
| -Nominal case, user call                                                                                | deleteTransaction                | unit       | statement coverage  |
| -Nominal case, transaction does not exist                                                               | deleteTransaction                | unit       | statement coverage  |
| -Exception case, id not provided                                                                        | deleteTransaction                | unit       | statement coverage  |
| -Exception case, wrong username in params                                                               | deleteTransaction                | unit       | statement coverage  |
| -Nominal case, admin call                                                                               | deleteTransactions               | unit       | statement coverage  |
| -Exception case, not an admin                                                                           | deleteTransactions               | unit       | statement coverage  |
| -Exception case, \_ids not passed                                                                       | deleteTransactions               | unit       | statement coverage  |
| -Exception case, one of the \_ids is empty                                                              | deleteTransactions               | unit       | statement coverage  |
| -Exception case, duplicate id in \_ids                                                                  | deleteTransactions               | unit       | statement coverage  |
| -Exception case, one id in \_ids does not exist                                                         | deleteTransactions               | unit       | statement coverage  |
| -Nominal only date                                                                                      | handleDateFilterParams           | unit       | statement coverage  |
| -returns correct filter object when from and upTo are provided                                          | handleDateFilterParams           | unit       | statement coverage  |
| -returns an error when date is provided with from or upTo                                               | handleDateFilterParams           | unit       | statement coverage  |
| -returns empty filter when date, from or upTo are not provided                                          | handleDateFilterParams           | unit       | statement coverage  |
| -returns an error if date is written wrong                                                              | handleDateFilterParams           | unit       | statement coverage  |
| -returns an error if upTo is written wrong                                                              | handleDateFilterParams           | unit       | statement coverage  |
| -returns an error if from is written wrong                                                              | handleDateFilterParams           | unit       | statement coverage  |
| -verifyAuth should return true for valid user authentication                                            | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return true for valid Admin authentication                                           | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return true for valid Group authentication                                           | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return false and error for token missing information on refreshToken                 | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return false and error for token missing information on accessToken                  | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return false and error for tokens not matching                                       | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth does not have an accessToken and should return unauthorized                                 | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return false for invalid user authentication                                         | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return false for invalid Admin authentication                                        | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return false for invalid Group authentication                                        | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return false if the User refresh token is not equal to the accessToken               | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return false if the refresh token role of an admin is a regular user                 | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return false if User is not part of a group                                          | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should create a new refreshToken if the other is expired                                    | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return a general error after the "Token is expired error" is raised                  | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return false and ask to login again if the tokens are expired                        | verifyAuth                       | unit       | statement coverage  |
| -verifyAuth should return false if a general error occurs                                               | verifyAuth                       | unit       | statement coverage  |
| should return empty list if there are no users                                                          | getUsers                         | unit       | statement coverage  |
| should retrieve list of all users                                                                       | getUsers                         | unit       | statement coverage  |
| should return error if user is not admin                                                                | getUsers                         | unit       | statement coverage  |
| should handle internal server errors                                                                    | getUsers                         | unit       | statement coverage  |
| should return 400 if the user does not exist                                                            | getUser                          | unit       | statement coverage  |
| should return error if non-Admin tries to get other than their account                                  | getUser                          | unit       | statement coverage  |
| should retrieve user info for admin                                                                     | getUser                          | unit       | statement coverage  |
| should retrieve user info for non-admin                                                                 | getUser                          | unit       | statement coverage  |
| should handle internal server errors                                                                    | getUser                          | unit       | statement coverage  |
| should create a new group when caller email included in the request                                     | createGroup                      | unit       | statement coverage  |
| should create a new group when caller email not included in the request                                 | createGroup                      | unit       | statement coverage  |
| should return an error if request body is missing attributes                                            | createGroup                      | unit       | statement coverage  |
| should return error if the group name passed in the request body is an empty string                     | createGroup                      | unit       | statement coverage  |
| should return error if group name is already registered                                                 | createGroup                      | unit       | statement coverage  |
| should return all the groups                                                                            | getGroups                        | unit       | statement coverage  |
| should return an empty array if there are no groups                                                     | getGroups                        | unit       | statement coverage  |
| should return error when called by an authenticated user who is not an admin                            | getGroups                        | unit       | statement coverage  |
| should handle internal server errors                                                                    | getGroups                        | unit       | statement coverage  |
| Unit test `getGroup`:                                                                                   | getGroups                        | unit       | statement coverage  |
| should retrieve group info                                                                              | getGroups                        | unit       | statement coverage  |
| should return an error if the group does not exist                                                      | getGroups                        | unit       | statement coverage  |
| returns error if user is not an admin and not a member of the group                                     | getGroups                        | unit       | statement coverage  |
| should handle internal server errors                                                                    | getGroups                        | unit       | statement coverage  |
| should add new members to a group                                                                       | addToGroup                       | unit       | statement coverage  |
| should return if the requested group does not exist                                                     | addToGroup                       | unit       | statement coverage  |
| should return an error if the request body is missing attributes                                        | addToGroup                       | unit       | statement coverage  |
| should return an error if all member emails are already in a group                                      | addToGroup                       | unit       | statement coverage  |
| should return an error if all member emails do not exist                                                | addToGroup                       | unit       | statement coverage  |
| should return an error if at least one of the member emails is not in a valid email format              | addToGroup statement coverage    | unit       | statement coverage  |
| should return an error if at least one of the member emails is an empty string                          | addToGroup                       | unit       | statement coverage  |
| should return an error if user is not authenticated                                                     | addToGroup                       | unit       | statement coverage  |
| should return an error if called by an authenticated user who is not admin and not part of the group    | addToGroup                       | unit       | statement coverage  |
| should handle internal server errors                                                                    | addToGroup                       | unit       | statement coverage  |
| should remove members from a group                                                                      | removeFromGroup                  | unit       | statement coverage  |
| should return a 400 error if the request body is missing attributes                                     | removeFromGroup                  | unit       | statement coverage  |
| should return 400 if group does not exist                                                               | removeFromGroup                  | unit       | statement coverage  |
| should return error if all the provided emails do not belong to the group                               | removeFromGroup                  | unit       | statement coverage  |
| should return error if all the provided emails do not exist in the database                             | removeFromGroup                  | unit       | statement coverage  |
| should return error if at least one of the member emails is not in a valid email format                 | removeFromGroup                  | unit       | statement coverage  |
| should return error if at least one of the member emails is an empty string                             | removeFromGroup                  | unit       | statement coverage  |
| should return error if the group contains only one member before deleting any user                      | removeFromGroup                  | unit       | statement coverage  |
| should return a 401 error if called by an authenticated user who is not part of the group and not admin | removeFromGroup                  | unit       | statement coverage  |
| should handle internal server errors                                                                    | removeFromGroup                  | unit       | statement coverage  |
| should delete a user and related transactions                                                           | deleteUser                       | unit       | statement coverage  |
| should return error if the requester is not an admin                                                    | deleteUser                       | unit       | statement coverage  |
| should return error if the request body is missing the email                                            | deleteUser                       | unit       | statement coverage  |
| should return error if the request body is empty                                                        | deleteUser                       | unit       | statement coverage  |
| should return error if the email in the request body is in the wrong format                             | deleteUser                       | unit       | statement coverage  |
| should return an error if the provided email does not exist in the database                             | deleteUser                       | unit       | statement coverage  |
| should delete the group and return success message                                                      | deleteGroup                      | unit       | statement coverage  |
| should return error if the group does not exist                                                         | deleteGroup                      | unit       | statement coverage  |

| Test case name                                                                                          | Object(s) tested                 | Test level  | Technique used |
| ------------------------------------------------------------------------------------------------------- | -------------------------------- | ----------- | -------------- |
| -exception, 500 error                                                                                   | register                         | integration | Black Box      |
| -nominal case                                                                                           | register                         | integration | Black Box      |
| -exception, missing password                                                                            | register                         | integration | Black Box      |
| -exception, missing email                                                                               | register                         | integration | Black Box      |
| -exception, missing username                                                                            | register                         | integration | Black Box      |
| -exception, empty username                                                                              | register                         | integration | Black Box      |
| -exception, empty email                                                                                 | register                         | integration | Black Box      |
| -exception, empty password                                                                              | register                         | integration | Black Box      |
| -exception, empty body                                                                                  | register                         | integration | Black Box      |
| -exception, already used email                                                                          | register                         | integration | Black Box      |
| -exception, already used username                                                                       | register                         | integration | Black Box      |
| -exception, wrong email format                                                                          | register                         | integration | Black Box      |
| -nominal case                                                                                           | registerAdmin                    | integration | Black Box      |
| -admin, exception, 500 error                                                                            | registerAdmin                    | integration | Black Box      |
| -admin, exception, missing password                                                                     | registerAdmin                    | integration | Black Box      |
| -admin, exception, missing email                                                                        | registerAdmin                    | integration | Black Box      |
| -admin, exception, missing username                                                                     | registerAdmin                    | integration | Black Box      |
| -admin, exception, empty username                                                                       | registerAdmin                    | integration | Black Box      |
| -admin, exception, empty email                                                                          | registerAdmin                    | integration | Black Box      |
| -admin, exception, empty password                                                                       | registerAdmin                    | integration | Black Box      |
| -admin, exception, empty body                                                                           | registerAdmin                    | integration | Black Box      |
| -admin, exception, already used email                                                                   | registerAdmin                    | integration | Black Box      |
| -admin, exception, already used username                                                                | registerAdmin                    | integration | Black Box      |
| -admin, exception, wrong email format                                                                   | registerAdmin                    | integration | Black Box      |
| -nominal case                                                                                           | login                            | integration | Black Box      |
| -exception, 500 error                                                                                   | login                            | integration | Black Box      |
| -exception, missing email                                                                               | login                            | integration | Black Box      |
| -exception, missing password                                                                            | login                            | integration | Black Box      |
| -exception, empty password                                                                              | login                            | integration | Black Box      |
| -exception, empty email                                                                                 | login                            | integration | Black Box      |
| -exception, empty body                                                                                  | login                            | integration | Black Box      |
| -exception, not valid email                                                                             | login                            | integration | Black Box      |
| -exception, wrong password                                                                              | login                            | integration | Black Box      |
| -exception, wrong user                                                                                  | login                            | integration | Black Box      |
| -Nominal scenario                                                                                       | logout                           | integration | Black Box      |
| -should return an error if refreshToken is missing in cookies                                           | logout                           | integration | Black Box      |
| -should return an error if user is not found                                                            | logout                           | integration | Black Box      |
| -should return a server error if an exception occurs                                                    | logout                           | integration | Black Box      |
| -Nominal case                                                                                           | createCategory                   | integration | Black Box      |
| -Exception case, no type or body                                                                        | createCategory                   | integration | Black Box      |
| -Exception case, empty type or body                                                                     | createCategory                   | integration | Black Box      |
| -Exception case, category already present in db                                                         | createCategory                   | integration | Black Box      |
| -Nominal case, admin call                                                                               | updateCategory                   | integration | Black Box      |
| -Exception case, body has missing info                                                                  | updateCategory                   | integration | Black Box      |
| -Exception case, body has empty info                                                                    | updateCategory                   | integration | Black Box      |
| -Exception case, old category does not exist                                                            | updateCategory                   | integration | Black Box      |
| -Exception case, new category already in db                                                             | updateCategory                   | integration | Black Box      |
| -Nominal case, admin call                                                                               | deleteCategory                   | integration | Black Box      |
| -Nominal case, admin call deleting all categories                                                       | deleteCategory                   | integration | Black Box      |
| -Exception case, user call                                                                              | deleteCategory                   | integration | Black Box      |
| -Exception case, types not passed                                                                       | deleteCategory                   | integration | Black Box      |
| -Exception case, only one category in db call                                                           | deleteCategory                   | integration | Black Box      |
| -Exception case, empty category passed                                                                  | deleteCategory                   | integration | Black Box      |
| -Exception case, one type is not in db                                                                  | deleteCategory                   | integration | Black Box      |
| -Exception case, not authorized                                                                         | getCategories                    | integration | Black Box      |
| -Nominal case                                                                                           | getCategories                    | integration | Black Box      |
| -Nominal case                                                                                           | createTransaction                | integration | Black Box      |
| -Exception case, unauthorized                                                                           | createTransaction                | integration | Black Box      |
| -Exception case, missing info in the body                                                               | createTransaction                | integration | Black Box      |
| -Exception case, parameter empty                                                                        | createTransaction                | integration | Black Box      |
| -Exception case, user in body is different than the one in params                                       | createTransaction                | integration | Black Box      |
| -Exception case, user in params does not exist                                                          | createTransaction                | integration | Black Box      |
| -Exception case, category not in db                                                                     | createTransaction                | integration | Black Box      |
| -Exception case, amount is not parsable                                                                 | createTransaction                | integration | Black Box      |
| -Nominal case                                                                                           | getAllTransactions               | integration | Black Box      |
| -Exception case, unauthorized                                                                           | getAllTransactions               | integration | Black Box      |
| -Nominal case, admin call                                                                               | getTransactionsByUser            | integration | Black Box      |
| -Exception case, user call on admin path                                                                | getTransactionsByUser            | integration | Black Box      |
| -Exception case, admin call, user in params does not exist                                              | getTransactionsByUser            | integration | Black Box      |
| -Nominal case, user call                                                                                | getTransactionsByUser            | integration | Black Box      |
| -Exception case, user call for another user's transactions                                              | getTransactionsByUser            | integration | Black Box      |
| -Exception case, user call username does not exist                                                      | getTransactionsByUser            | integration | Black Box      |
| -Nominal case, admin call                                                                               | getTransactionsByUserByCategory  | integration | Black Box      |
| -Exception case, user call on admin path                                                                | getTransactionsByUserByCategory  | integration | Black Box      |
| -Exception case, admin call, user in params does not exist                                              | getTransactionsByUserByCategory  | integration | Black Box      |
| -Exception case, admin call, category in params does not exist                                          | getTransactionsByUserByCategory  | integration | Black Box      |
| -Nominal case, user call                                                                                | getTransactionsByUserByCategory  | integration | Black Box      |
| -Exception case, user call for another user's transactions                                              | getTransactionsByUserByCategory  | integration | Black Box      |
| -Exception case, user call, username doesn't exist                                                      | getTransactionsByUserByCategory  | integration | Black Box      |
| -Exception case, user call, category does not exist                                                     | getTransactionsByUserByCategory  | integration | Black Box      |
| -Nominal case, admin call                                                                               | getTransactionsByGroup           | integration | Black Box      |
| -Exception case, user calls on admin path                                                               | getTransactionsByGroup           | integration | Black Box      |
| -Exception case, admin call group does not exist                                                        | getTransactionsByGroup           | integration | Black Box      |
| -Nominal case, user call                                                                                | getTransactionsByGroup           | integration | Black Box      |
| -Exception case, user not in group                                                                      | getTransactionsByGroup           | integration | Black Box      |
| -Nominal case, admin call                                                                               | getTransactionsByGroupByCategory | integration | Black Box      |
| -Exception case, user calls on admin path                                                               | getTransactionsByGroupByCategory | integration | Black Box      |
| -Exception case, admin call group does not exist                                                        | getTransactionsByGroupByCategory | integration | Black Box      |
| -Exception case, admin call category does not exist                                                     | getTransactionsByGroupByCategory | integration | Black Box      |
| -Nominal case, user call                                                                                | getTransactionsByGroupByCategory | integration | Black Box      |
| -Exception case, user call for another user's transactions                                              | getTransactionsByGroupByCategory | integration | Black Box      |
| -Exception case, user call, username doesn't exist                                                      | getTransactionsByGroupByCategory | integration | Black Box      |
| -Exception case, user call, category does not exist                                                     | getTransactionsByGroupByCategory | integration | Black Box      |
| -Nominal case, user call                                                                                | deleteTransaction                | integration | Black Box      |
| -Nominal case, transaction does not exist                                                               | deleteTransaction                | integration | Black Box      |
| -Exception case, id not provided                                                                        | deleteTransaction                | integration | Black Box      |
| -Exception case, wrong username in params                                                               | deleteTransaction                | integration | Black Box      |
| -Nominal case, admin call                                                                               | deleteTransactions               | integration | Black Box      |
| -Exception case, not an admin                                                                           | deleteTransactions               | integration | Black Box      |
| -Exception case, \_ids not passed                                                                       | deleteTransactions               | integration | Black Box      |
| -Exception case, one of the \_ids is empty                                                              | deleteTransactions               | integration | Black Box      |
| -Exception case, duplicate id in \_ids                                                                  | deleteTransactions               | integration | Black Box      |
| -Exception case, one id in \_ids does not exist                                                         | deleteTransactions               | integration | Black Box      |
| -Nominal only date                                                                                      | handleDateFilterParams           | integration | Black Box      |
| -returns correct filter object when from and upTo are provided                                          | handleDateFilterParams           | integration | Black Box      |
| -returns an error when date is provided with from or upTo                                               | handleDateFilterParams           | integration | Black Box      |
| -returns empty filter when date, from or upTo are not provided                                          | handleDateFilterParams           | integration | Black Box      |
| -returns an error if date is written wrong                                                              | handleDateFilterParams           | integration | Black Box      |
| -returns an error if upTo is written wrong                                                              | handleDateFilterParams           | integration | Black Box      |
| -returns an error if from is written wrong                                                              | handleDateFilterParams           | integration | Black Box      |
| -verifyAuth should return true for valid user authentication                                            | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return true for valid Admin authentication                                           | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return true for valid Group authentication                                           | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return false and error for token missing information on refreshToken                 | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return false and error for token missing information on accessToken                  | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return false and error for tokens not matching                                       | verifyAuth                       | integration | Black Box      |
| -verifyAuth does not have an accessToken and should return unauthorized                                 | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return false for invalid user authentication                                         | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return false for invalid Admin authentication                                        | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return false for invalid Group authentication                                        | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return false if the User refresh token is not equal to the accessToken               | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return false if the refresh token role of an admin is a regular user                 | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return false if User is not part of a group                                          | verifyAuth                       | integration | Black Box      |
| -verifyAuth should create a new refreshToken if the other is expired                                    | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return a general error after the "Token is expired error" is raised                  | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return false and ask to login again if the tokens are expired                        | verifyAuth                       | integration | Black Box      |
| -verifyAuth should return false if a general error occurs                                               | verifyAuth                       | integration | Black Box      |
| should return empty list if there are no users                                                          | getUsers                         | integration | Black Box      |
| should retrieve list of all users                                                                       | getUsers                         | integration | Black Box      |
| should return error if user is not admin                                                                | getUsers                         | integration | Black Box      |
| should handle internal server errors                                                                    | getUsers                         | integration | Black Box      |
| should return 400 if the user does not exist                                                            | getUser                          | integration | Black Box      |
| should return error if non-Admin tries to get other than their account                                  | getUser                          | integration | Black Box      |
| should retrieve user info for admin                                                                     | getUser                          | integration | Black Box      |
| should retrieve user info for non-admin                                                                 | getUser                          | integration | Black Box      |
| should handle internal server errors                                                                    | getUser                          | integration | Black Box      |
| should create a new group when caller email included in the request                                     | createGroup                      | integration | Black Box      |
| should create a new group when caller email not included in the request                                 | createGroup                      | integration | Black Box      |
| should return an error if request body is missing attributes                                            | createGroup                      | integration | Black Box      |
| should return error if the group name passed in the request body is an empty string                     | createGroup                      | integration | Black Box      |
| should return error if group name is already registered                                                 | createGroup                      | integration | Black Box      |
| should return all the groups                                                                            | getGroups                        | integration | Black Box      |
| should return an empty array if there are no groups                                                     | getGroups                        | integration | Black Box      |
| should return error when called by an authenticated user who is not an admin                            | getGroups                        | integration | Black Box      |
| should handle internal server errors                                                                    | getGroups                        | integration | Black Box      |
| Unit test `getGroup`:                                                                                   | getGroups                        | integration | Black Box      |
| should retrieve group info                                                                              | getGroups                        | integration | Black Box      |
| should return an error if the group does not exist                                                      | getGroups                        | integration | Black Box      |
| returns error if user is not an admin and not a member of the group                                     | getGroups                        | integration | Black Box      |
| should handle internal server errors                                                                    | getGroups                        | integration | Black Box      |
| should add new members to a group                                                                       | addToGroup                       | integration | Black Box      |
| should return if the requested group does not exist                                                     | addToGroup                       | integration | Black Box      |
| should return an error if the request body is missing attributes                                        | addToGroup                       | integration | Black Box      |
| should return an error if all member emails are already in a group                                      | addToGroup                       | integration | Black Box      |
| should return an error if all member emails do not exist                                                | addToGroup                       | integration | Black Box      |
| should return an error if at least one of the member emails is not in a valid email format              | addToGroup Black Box             | integration | Black Box      |
| should return an error if at least one of the member emails is an empty string                          | addToGroup                       | integration | Black Box      |
| should return an error if user is not authenticated                                                     | addToGroup                       | integration | Black Box      |
| should return an error if called by an authenticated user who is not admin and not part of the group    | addToGroup                       | integration | Black Box      |
| should handle internal server errors                                                                    | addToGroup                       | integration | Black Box      |
| should remove members from a group                                                                      | removeFromGroup                  | integration | Black Box      |
| should return a 400 error if the request body is missing attributes                                     | removeFromGroup                  | integration | Black Box      |
| should return 400 if group does not exist                                                               | removeFromGroup                  | integration | Black Box      |
| should return error if all the provided emails do not belong to the group                               | removeFromGroup                  | integration | Black Box      |
| should return error if all the provided emails do not exist in the database                             | removeFromGroup                  | integration | Black Box      |
| should return error if at least one of the member emails is not in a valid email format                 | removeFromGroup                  | integration | Black Box      |
| should return error if at least one of the member emails is an empty string                             | removeFromGroup                  | integration | Black Box      |
| should return error if the group contains only one member before deleting any user                      | removeFromGroup                  | integration | Black Box      |
| should return a 401 error if called by an authenticated user who is not part of the group and not admin | removeFromGroup                  | integration | Black Box      |
| should handle internal server errors                                                                    | removeFromGroup                  | integration | Black Box      |
| should delete a user and related transactions                                                           | deleteUser                       | integration | Black Box      |
| should return error if the requester is not an admin                                                    | deleteUser                       | integration | Black Box      |
| should return error if the request body is missing the email                                            | deleteUser                       | integration | Black Box      |
| should return error if the request body is empty                                                        | deleteUser                       | integration | Black Box      |
| should return error if the email in the request body is in the wrong format                             | deleteUser                       | integration | Black Box      |
| should return an error if the provided email does not exist in the database                             | deleteUser                       | integration | Black Box      |
| should delete the group and return success message                                                      | deleteGroup                      | integration | Black Box      |
| should return error if the group does not exist                                                         | deleteGroup                      | integration | Black Box      |

# Coverage

## Coverage of FR

<Report in the following table the coverage of functional requirements (from official requirements) >

| ID                                    | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| FR1 Manage users                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| FR11 register                         | - should return confirmation for registration<br>- no username<br>- no email<br>- no password<br>- empty username<br>- empty email<br>- empty password<br>- empty body<br>- invalid email format<br>- already used email<br>- already used user<br>- nominal case<br>- property not provided<br>- empty property<br>- already present category                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| FR12 login                            | - should return accessToken and refreshToken<br>- missing email<br>- missing password<br>- empty email<br>- empty password<br>- wrong email format<br>- incorrect email<br>- incorrect password                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| FR13 logout                           | - Nominal scenario<br> -should return an error if refreshToken is missing in cookies<br> -should return an error if user is not found<br> -should return a server error if an exception occurs<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| FR14 registerAdmin                    | - should return confirmation for registration (registerAdmin)<br>- no username (registerAdmin)<br>- no email (registerAdmin)<br>- no password (registerAdmin)<br>- empty username (registerAdmin)<br>- empty email (registerAdmin)<br>- empty password (registerAdmin)<br>- empty body (registerAdmin)<br>- invalid email format (registerAdmin)<br>- already used email (registerAdmin)<br>- already used user (registerAdmin)                                                                                                                                                                                                                                                                                                                                                                            |
| FR15 getUsers                         | - should return empty list if there are no users<br>- should retrieve list of all users<br>- should handle internal server errors                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| FR16 getUser                          | - should return error if user doesn't exist<br>- should return error if non-Admin tries to get other than their account<br>- should retrieve user info for admin<br>- should retrieve user info for non-admin<br>- should handle internal server errors                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| FR17 deleteUser                       | - should delete a user and related transactions<br>- should return an error if called by an unauthorized user<br>- should return an error if the provided email does not exist in the database                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| FR2 Manage groups                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| FR21 createGroup                      | - should create a new group<br>- should return error if the request body does not contain all the necessary attributes<br>- should return error if the group name passed in the request body is an empty string<br>- should return error if group name is already registered<br>- should return error if all the provided emails are already in a group<br>- should return error if all the provided emails do not exist in the database<br>- should return error if the user who calls the API is already in a group<br>- should return error if at least one of the member emails is not in a valid email format<br>- should return error if at least one of the member emails is an empty string<br>- should return error if group name is already registered<br>- should handle internal server errors |
| FR22 getGroups                        | - should return all the groups<br>- should return an empty array if there are no groups<br>- should return an 'Unauthorized' error if not authorized<br>- should handle internal server errors                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| FR23 getGroup                         | - should retrieve group info<br>- returns group not found if group does not exist<br>- returns error if user is not an admin and not a member of the group<br>- should handle internal server errors                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| FR24 addToGroup                       | - should add new members to a group<br>- should return error if the provided group name does not exist<br>- should return error if the request body does not contain all the necessary attributes<br>- should return error if all the provided emails are already in a group<br>- should return error if all the provided emails do not exist in the database<br>- should return error if at least one of the member emails is not in a valid email format<br>- should return error if at least one of the member emails is an empty string<br>- should return error if called by an authenticated user who is not admin and not part of the group<br>- should handle internal server errors                                                                                                               |
| FR26 removeFromGroup                  | - removeFromGroup<br>- should remove members from a group<br>- should return error if the request body does not contain all the necessary attributes<br>- should return 400 if group does not exist<br>- should return error if all the provided emails do not belong to the group<br>- should return error if all the provided emails do not exist in the database<br>- should return error if at least one of the member emails is not in a valid email format<br>- should return error if at least one of the member emails is an empty string<br>- should error if the group contains only one member before deleting any user<br>- should return 401 if user is not allowed to remove from group<br>- should handle internal server errors                                                            |
| FR28 deleteGroup                      | - should delete the group and return success message<br>- should return an error if the group does not exist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| FR3 Manage transactions               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| FR31 createTransaction                | - nominal case<br>- exception case, unauthorized<br>- exception case, missing info in the body<br>- exception case, empty strings in the body<br>- exception case, modifying another user's transactions<br>- exception case, username does not exist<br>- exception case, category does not exist<br>- exception case, amount is not parsable                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| FR32 getAllTransactions               | - nominal case<br>- exception case, unauthorized                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| FR33 getTransactionsByUser            | - nominal case, admin call<br>- exception case, user call on admin path<br>- exception case, admin call username does not exist<br>- nominal case, user call<br>- exception case, user call for another user<br>- exception case, user call username does not exist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| FR34 getTransactionsByUserByCategory  | - nominal case, admin call<br>- exception case, user call on admin path<br>- exception case, admin call username doesn't exist<br>- exception case, admin call category does not exist<br>- nominal case, user call<br>- exception case, user call for another user<br>- exception case, user call username doesn't exist<br>- exception case, user call category does not exist                                                                                                                                                                                                                                                                                                                                                                                                                           |
| FR35 getTransactionsByGroup           | - nominal case, admin call<br>- exception case, user call on admin path<br>- admin call, group does not exist<br>- nominal case, user call<br>- user call, member not in group                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| FR36 getTransactionsByGroupByCategory | - nominal case, admin call<br>- exception case, user call on admin path<br>- exception case, admin call group does not exist<br>- exception case, admin call category does not exist<br>- nominal case, user call                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| FR37 deleteTransaction                | - user call<br>- user call, transaction does not exist<br>- user call, id not provided<br>- user call, wrong username in params                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| FR38 deleteTransactions               | - all ids exist<br>- one id does not exist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| FR4 Manage categories                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| FR41 createCategory                   | - nominal case<br>- property not provided<br>- empty property<br>- already present category                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| FR42 updateCategory                   | - update category<br>- type or color missing<br>- type or color empty<br>- old category does not exist<br>- new category exists already                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| FR43 deleteCategory                   | - normal case<br>- not passing types<br>- one category in db<br>- empty category passed<br>- category to delete not found                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| FR44 getCategories                    | - No categories<br>- Various categories                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

## Coverage white box

![Test_coverage](./images/test_coverage.png)

![Test_coverage_html](./images/Test_coverage_page.jpg)
